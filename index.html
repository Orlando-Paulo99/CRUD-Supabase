<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>Dados para serem deletados</h1>
    <input type="text" id="deleteCpf">
    <button onclick="deletarCpf()">Excluir</button>

    
    <h1>Dados para inserir<h1>
    <input type="text" id="inserCpf">
    <input type="text" id="nome">
    <input type="text" id="idade">
    <button onclick="inserir()">Inserir Dados</button>

    <div id="dadosSupa">

    </div>


    <h1>Dados para Atulizar</h1>
    <input type="text" id="cpf" placeholder="insira o CPF que você deseja alterar o nome">
    <input type="text" id="dados" placeholder="insira o novo nome">
    <button onclick="atualizando()">atualizar</button>

</body>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>

let apresentar=document.getElementById("dadosSupa")


const supabaseUrl = 'https://ofxudymzwrgluaeppcnp.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9meHVkeW16d3JnbHVhZXBwY25wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjEzMzg4MTMsImV4cCI6MjA3NjkxNDgxM30.D8O_WBcrBrZfbj84cerqjwFGFeUwWXVeOaD9jHPSBR4';
const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

//inserindo os dado

async function inserir() {

    let cpfN=document.getElementById('inserCpf').value;
    let nome=document.getElementById('nome').value;
    let idade=document.getElementById('idade').value;

    const{data,error} =await supabase
    .from('crud')
    .insert([
        {cpf:cpfN ,nome: nome , idade: idade}

    ]);

    if(error){
        console.log("erro ao inserir dados"+error)
        return

    }

    console.log("inserido com sucesso");
    cpfN.value="";
    nome.value="";
    idade.value="";


}
inserir();

//ler os dados
async function listarDados() {
    const{data,error}= await supabase
    .from('crud')
    .select('*')


    if(error){
        console.log('erro ao conssultar dados')
        return
    }
    
    console.log(data);
    data.forEach(element => {
        apresentar.innerHTML += "CPF: "+element.cpf+"<br>" + "Nome: "+ element.nome+ "<br>" +"Idade: "+element.idade
        
    });
}
listarDados();



//atualizar os dados


async function atualizando() {

    let cpf=document.getElementById("cpf").value;
let novoDado=document.getElementById("dados").value;


    const { data, error } = await supabase
        .from('crud')
        .update({ nome: novoDado })
        .eq('cpf', cpf); // Use um cpf existente

    if (error) {
        console.log('Erro ao atualizar:', error);
        return;
    }

    console.log('Atualizado com sucesso:', data);
}
atualizando();



//deletar os dados
async function deletarCpf() {

    let deleteCpf=document.getElementById("deleteCpf").value

    const {data,error} = await supabase
    .from('crud')
    .delete()
    //informo a coluna que vai ser excluida e o deleteCpf é o valor que vai ser recebido pelo usuario para ser excluido
    .eq('cpf',Number(deleteCpf))

    if(error){
        console.log(error)
        return
    }
    console.log("excluido com sucesso");
    
}

</script>
</html>